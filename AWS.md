# KudiNodes Kubernetes Infrastructure

## VPC Network
| Name                      | Description                                                                                                                                                                    | Type         | Default       |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|---------------|
| create_vpc                | Flag to create VPC                                                                                                                                                             | bool         | false         |
| vpc_id                    | Identifier for an existing VPC to use                                                                                                                                          | string       |               |
| cidr_block                | CIDR block for the vpc network to be created                                                                                                                                   | string       | 172.16.0.0/24 |
| public_subnet_cidr_block  | List of CIDR blocks for the public subnet in the VPC                                                                                                                           | list(string) |               |
| private_subnet_cidr_block | List of CIDR blocks for the private subnet in the VPC                                                                                                                          | list(string) |               |
| enable_dns_hostnames      | Flag to enable DNS hostnames                                                                                                                                                   | bool         |               |
| enable_dns_support        | Flag to enable DNS support                                                                                                                                                     | bool         |               |
| enable_ipv6               | Flag to enable IPV6                                                                                                                                                            | bool         |               |
| nat_type                  | Type of NAT device to be created<br>instance - create an ec2 instance<br>gateway - create a NAT Gateway                                                                        | string       | instance      |
| nat_key_name              | The ec2 key pair name to be used for accessing the NAT instance.<br>The instance will not be accessible if a value is not provided.                                            | string       |               |
| nat_instance_type         | The type of ec2 instance for the NAT device when an instance type is selected.<br>Reference ec2 documentation for available options https://aws.amazon.com/ec2/instance-types/ | string       | t2.nano       |

## EKS Cluster
| Name                      | Description                                                                                                                                                                                                                                                                                                | Type         | Default                                                                                                                                                                          |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| create_eks                | Flag to create a new EKS cluster                                                                                                                                                                                                                                                                           | bool         | false                                                                                                                                                                            |
| cluster_version           | The version of the Kubernetes cluster to create                                                                                                                                                                                                                                                            | string       | 1.18                                                                                                                                                                             |
| cluster_log_retention     | The value in days for cluster log retention                                                                                                                                                                                                                                                                | number       | 7                                                                                                                                                                                |
| cluster_enabled_log_types | List of cluster log types to enable<br>The following types are available<br>api, audit, authentication, controllerManager, scheduler                                                                                                                                                                       | list(string) | ["api", "audit", "authentication",<br>"controllerManager", "scheduler"]                                                                                                          |
| cluster_default_ami_type  | Default ec2 instance AMI type for the cluster                                                                                                                                                                                                                                                              | string       | AL2_x86_64                                                                                                                                                                       |
| cluster_default_disk_size | Default disk size for each ec2 instance                                                                                                                                                                                                                                                                    | string       | 50                                                                                                                                                                               |
| cluster_nodes             | List of node Types to be created<br><br>The following attributes are required for each ojbect:<br>desired_capacity - number<br>max_capacity     - number<br>min_capacity     - number<br>instance_type    - string (Reference https://aws.amazon.com/ec2/instance-types)<br>k8s_labels       - map(string) | list(object) | blockchain-nodes = {<br>  desired_capacity = 3<br>  max_capacity     = 4<br>  min_capacity     = 1<br>  instance_type    = "m5.xlarge"<br>  k8s_labels       = {<br><br>  }<br>} |
| cluster_accounts          | Additional AWS account numbers to add to aws-auth configmap                                                                                                                                                                                                                                                | list(string) |                                                                                                                                                                                  |
| cluster_roles             | Additional IAM roles to add to the aws-auth configmap<br><br>The following attributes are required for each object:<br>rolearn  - string<br>username - string<br>groups   - list(string)                                                                                                                   | list(object) |                                                                                                                                                                                  |
| cluster_users             | Additional IAM users to add to the aws-auth configmap<br><br>The following attributes are required for each object:<br>userarn  - string<br>username - string<br>groups   - list(string)                                                                                                                   | list(object) |                                                                                                                                                                                  |
## ECR
| Name | Description | Type | Default |
|------|-------------|------|---------|
| create_ecr | Flag to create a new ECR Repository | bool | false |
| scan_images | Flag to scan images upon push | bool | true |
| timeouts_delete | Timeout value on deletion | string | 60m |
| image_tag_mutability | Image tag mutability | string | MUTABLE |
| ecr_actions | list of policy actions to enable for the ECR repository | string | "ecr:*" |


## S3
